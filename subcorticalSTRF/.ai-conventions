# AI Assistant Project Conventions
# Created: 2025-11-26 16:20:00
#
# This file defines conventions for AI assistants working on this project.
# It ensures consistent file organization, naming, and documentation standards.

## FILE ORGANIZATION

### Test Files
- All test files MUST be placed in: `tests/`
- Test file naming: `test_*.py`
- Each test file should have a header with creation date/time

### Documentation Files
- All documentation MUST be placed in: `documentation/`
- Documentation formats: `.md` (Markdown)
- Each doc file should have a header with creation date/time

### Source Code
- Models: `models/` (e.g., `models/WSRmodel/`, `models/BEZ2018/`)
- Utilities: `loggers/`, `stim_generator/`, etc.
- Main scripts: Root directory for now (consider organizing later)

### Data and Results
- Analysis results: `analyses/`
- Model outputs: `models/*/results/` or `model_comparisons/results/`
- Temporary data: `tests/test_data/` (gitignored)

## FILE HEADERS

### Python Files
All Python files should start with:
```python
"""
Module description here.

Created: YYYY-MM-DD HH:MM:SS
Author: [Name] (with AI assistance)
"""
```

### Markdown Documentation Files
All documentation files should start with:
```markdown
# Document Title

**Created:** YYYY-MM-DD HH:MM:SS  
**Last Updated:** YYYY-MM-DD HH:MM:SS

Brief description of document purpose.
```

### Test Files
```python
"""
Test suite for [component name].

Created: YYYY-MM-DD HH:MM:SS
Purpose: [Brief description of what is being tested]
"""
```

## NAMING CONVENTIONS

### Files
- Python modules: `lowercase_with_underscores.py`
- Test files: `test_component_name.py`
- Documentation: `UPPERCASE_WITH_UNDERSCORES.md` or `Title_Case.md`
- Configuration: `.lowercase` or `lowercase.yaml`

### Code
- Classes: `PascalCase` (e.g., `FolderManager`, `WSRModel`)
- Functions: `lowercase_with_underscores` (e.g., `create_folder`, `process_tone`)
- Constants: `UPPERCASE_WITH_UNDERSCORES`
- Private methods: `_leading_underscore`

## LOGGING

### Use the loggers Module
```python
from loggers import FolderManager, LoggingConfigurator, MetadataSaver
import logging

# Setup logging early
LoggingConfigurator.setup_basic(output_dir, 'script_name.log')
logger = logging.getLogger(__name__)

# Use logger instead of print
logger.info("Information message")
logger.warning("Warning message")
logger.error("Error message")
```

### Log File Naming
- Simulations: `{model_name}_simulation.log`
- Analyses: `{analysis_type}_analysis.log`
- Comparisons: `{model1}_vs_{model2}_comparison.log`

## OUTPUT ORGANIZATION

### Use FolderManager for Outputs
```python
from loggers import FolderManager

# Use registered builders or custom functions
manager = FolderManager(base_dir, name_builder)
output_dir = manager.with_params(**params).create_folder()
```

### Standard Output Structure
```
results/descriptive_name_TIMESTAMP/
├── params.json              # Full parameters
├── {script_name}.log        # Run log
├── summary.json            # Key statistics (MetadataSaver)
├── data/                   # Subfolder for data files
├── figures/                # Subfolder for plots
└── README.txt              # Brief description
```

## METADATA AND REPRODUCIBILITY

### Always Save Parameters
```python
# Parameters saved automatically by FolderManager
manager.with_params(
    param1=value1,
    param2=value2,
    timestamp=datetime.now().isoformat(),
    git_commit=subprocess.check_output(['git', 'rev-parse', 'HEAD']).decode().strip()
)
```

### Use MetadataSaver for Results
```python
from loggers import MetadataSaver

saver = MetadataSaver()
saver.save_json(output_dir, results_dict, 'results_summary.json')
```

## DOCUMENTATION STANDARDS

### Code Documentation
- All modules: Docstring at top
- All classes: Docstring with Args and attributes
- All public functions: Docstring with Args, Returns, and example
- Complex algorithms: Inline comments

### README Files
Each major directory should have a README.md explaining:
- Purpose of the directory
- Key files and their roles
- How to run scripts
- Dependencies

## IMPORTS

### Standard Order
1. Standard library
2. Third-party packages
3. Local imports (absolute or relative)

```python
# Standard library
import logging
from pathlib import Path
from typing import Dict, List, Optional

# Third-party
import numpy as np
import matplotlib.pyplot as plt

# Local
from loggers import FolderManager, LoggingConfigurator
from models.WSRmodel import WSRModel
```

## GIT CONVENTIONS

### Branch Naming
- Features: `feature/description`
- Fixes: `fix/description`
- Experiments: `experiment/description`

### Commit Messages
- Format: `[Component] Brief description`
- Examples:
  - `[Loggers] Add LoggingConfigurator class`
  - `[WSR] Refactor to use new loggers module`
  - `[Docs] Update usage guide for model comparison`

## TESTING

### Test Structure
```python
def test_feature_name():
    """Test description."""
    # Arrange
    setup_code()
    
    # Act
    result = function_to_test()
    
    # Assert
    assert result == expected
```

### Run Tests
```bash
# Run all tests
python -m pytest tests/

# Run specific test
python -m pytest tests/test_specific.py

# Run with coverage
python -m pytest --cov=. tests/
```

## AI ASSISTANT REMINDERS

1. **Always place test files in `tests/`**
2. **Always place documentation in `documentation/`**
3. **Always add timestamp headers to new files**
4. **Always use FolderManager for organized outputs**
5. **Always use LoggingConfigurator instead of manual logging setup**
6. **Always replace print() with logger calls in production code**
7. **Always save metadata with MetadataSaver**
8. **Never create documentation files in root directory**
9. **Never create test files in root directory**
10. **Always check if similar functionality exists before creating new code**

## EXAMPLES

### Creating a New Analysis Script
```python
"""
Analysis of [specific topic].

Created: 2025-11-26 16:20:00
Author: Ekim Celikay (with AI assistance)
"""
import logging
from pathlib import Path
from loggers import FolderManager, LoggingConfigurator, MetadataSaver

logger = logging.getLogger(__name__)

def main():
    # Setup output
    manager = FolderManager('./results', 'model_comparison')
    output_dir = manager.with_params(
        analysis_type='my_analysis',
        version='v1'
    ).create_folder()
    
    # Setup logging
    LoggingConfigurator.setup_basic(output_dir, 'analysis.log')
    logger.info("Starting analysis...")
    
    # Run analysis
    results = run_analysis()
    
    # Save results
    MetadataSaver().save_json(output_dir, results, 'summary.json')
    logger.info(f"Results saved to {output_dir}")

if __name__ == '__main__':
    main()
```

### Creating a New Test
```python
"""
Test suite for FolderManager class.

Created: 2025-11-26 16:20:00
Purpose: Verify FolderManager creates correct directory structures
"""
import pytest
from pathlib import Path
from loggers import FolderManager

def test_folder_creation():
    """Test that FolderManager creates folders correctly."""
    manager = FolderManager('/tmp/test')
    output_dir = manager.with_params(test=True).create_folder()
    
    assert Path(output_dir).exists()
    assert (Path(output_dir) / 'params.json').exists()
```

## VERSION HISTORY

- 2025-11-26: Initial conventions established
- Future updates will be logged here
